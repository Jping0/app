webpackJsonp([5],{"1XsU":function(t,e){},O88V:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("mvHQ"),s=i.n(a),o={name:"drawingboard",data:function(){return{handleStatus:!1,showNum:0,showSaveStatus:!1,createImgUrl:""}},mounted:function(){this.initDraw()},methods:{initDraw:function(){console.log(window);var t,e,i,a,s=window.devicePixelRatio,o=!1,n=document.getElementById("mycanvas"),c=n.getContext("2d");t=window.innerWidth,e=window.innerHeight,console.log(t+"----"+e);var l=document.querySelector(".main_canvas");l.style.cssText="width:winWidth;height:winHeight",i=t*s,a=e*s,n.width=i,n.height=a,n.width,n.height;var r={x:0,y:0},u={x:0,y:0},d=!1;function v(t){var e=t||window.event;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}n.onmousedown=function(t){r.x=t.pageX-void 0,r.y=t.pageY,d=!0},n.onmousemove=function(t){v(t),o?d&&(r.x=t.pageX-void 0,r.y=t.pageY,u.x=t.pageX-void 0,u.y=t.pageY,w(r.x,r.y,u.x,u.y)):d&&(u.x=t.pageX-void 0,u.y=t.pageY,w(r.x,r.y,u.x,u.y)),o=!1},n.onmouseup=function(t){v(t),d=!1,r.x=0,r.y=0,u.x=0,u.y=0},window.onmouseup=function(){d=!1},window.onmousemove=function(t){(t.pageX>n.width+void 0||t.pageX<n.width+void 0||t.pageY<0||t.pageY>n.height)&&(o=!0)},n.addEventListener("touchstart",function(t){r.x=t.touches[0].clientX*s,r.y=t.touches[0].clientY*s},!1),n.addEventListener("touchmove",function(t){u.x=t.touches[0].clientX*s,u.y=t.touches[0].clientY*s,w(r.x,r.y,u.x,u.y)},!1);var h=1;h*=s;var g="black",m=new Image;function w(t,e,i,a){c.beginPath(),c.restore(),c.save(),c.lineWidth=h,c.strokeStyle=g,c.moveTo(t,e),c.lineTo(i,a),c.stroke(),r.x=i,r.y=a,c.restore(),c.save()}function p(t,e,i,a){c.restore(),c.save(),c.beginPath(),c.drawImage(m,t,e,i,a),c.restore(),c.save()}m.src="",document.getElementById("upimgs").addEventListener("change",function(){console.log("有选择");var t,e=this.files[0];console.log(e),void 0!=window.createObjectURL?(t=window.createObjectURL(e),console.log(window.createObjectURL(e))):void 0!=window.URL?(t=window.URL.createObjectURL(e),console.log(window.URL.createObjectURL(e))):void 0!=window.webkitURL&&(t=window.webkitURL.createObjectURL(e),console.log(window.webkitURL.createObjectURL(e))),m.src=t,m.onload=function(){var t=m.width/m.height,e=(m.width,m.height,n.width/t),i=n.height*t;e>n.height?p(0,-(e-n.height)/2,n.width,e):e<n.height&&p(-(i-n.width)/2,0,i,n.height)}}),document.getElementById("color_val").addEventListener("input",function(t){g=t.target.value,console.log(t)}),document.getElementById("sib_linecx").addEventListener("input",function(t){h=t.target.value,console.log(t)}),document.getElementById("sig_clear").addEventListener("click",function(){c.beginPath(),c.clearRect(0,0,n.width,n.height),c.restore(),c.save()});document.getElementById("save_sig"),document.querySelector(".create_imgs"),document.querySelector(".create_imgbox"),document.querySelector(".modal_bg")},showHandles:function(){var t=this;this.showNum=++this.showNum,3==this.showNum&&(this.handleStatus=!0,this.showNum=0),clearTimeout(t.setLoop),t.setLoop=setTimeout(function(){t.showNum=0,console.log(t.showNum)},1e3)},closeHandle:function(){this.handleStatus=!1,this.showNum=0},touchmoves:function(t){0!=this.showNum&&(this.showNum=0)},createImg:function(){var t=document.getElementById("mycanvas"),e=document.querySelector(".create_imgbox"),i=new Image;i.setAttribute("crossOrigin","Anonymous"),i.src=t.toDataURL("image/png"),this.createImgUrl=t.toDataURL("image/png"),console.log(i),i.style.cssText="width: 100%;display:block;",i.onload=function(){e.appendChild(i)},this.showSaveStatus=!0,this.handleStatus=!1},closeSaveImg:function(){var t=document.querySelector(".create_imgbox");console.log(t.children),t.removeChild(t.firstChild),this.showSaveStatus=!1},saveImgs:function(){var t=this;if(this.isApp){var e=api.require("trans");t.saveTime=setTimeout(function(){api.confirm({title:"提示",msg:"是否保存图片？",buttons:["确定","取消"]},function(i,a){i.buttonIndex;var o=(new Date).getTime()+".png";1==i.buttonIndex&&e.saveImage({album:!0,base64Str:t.createImgUrl.replace("data:image/png;base64,",""),imgPath:"fs://image",imgName:o},function(e,i){e.status?api.saveMediaToAlbum({path:api.fsDir+"/image/"+o},function(e,i){e&&e.status?t.showMsg({text:"保存成功!"}):alert(s()(e)||s()(i))}):alert(s()(i))})})},600)}else this.showMsg({text:"无法保存图片！"})},closeSaves:function(){this.isApp&&clearTimeout(this.saveTime)}}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"drawingboard"},[i("div",{staticClass:"main_box"},[i("div",{staticClass:"main_canvas"},[i("canvas",{attrs:{id:"mycanvas"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.showHandles(e)},touchmove:function(e){return e.stopPropagation(),e.preventDefault(),t.touchmoves(e)}}})]),t._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:t.handleStatus,expression:"handleStatus"}],staticClass:"drawingHBoxbg",on:{click:t.closeHandle}}),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.handleStatus,expression:"handleStatus"}],staticClass:"drawingHInbox"},[i("div",{staticClass:"signature_btn"},[i("ul",{staticClass:"flexbox"},[i("li",{staticClass:"flex1"},[i("div",{staticClass:"sig_cxline"},[i("select",{attrs:{name:"",id:"sib_linecx"}},[i("option",{attrs:{value:"1"}},[t._v("1")]),t._v(" "),i("option",{attrs:{value:"2"}},[t._v("2")]),t._v(" "),i("option",{attrs:{value:"3"}},[t._v("3")]),t._v(" "),i("option",{attrs:{value:"4"}},[t._v("4")]),t._v(" "),i("option",{attrs:{value:"5"}},[t._v("5")])])])]),t._v(" "),i("li",{staticClass:"flex1"},[i("div",{staticClass:"sig_colors"},[i("input",{attrs:{id:"color_val",type:"color",readonly:"",placeholder:"选择颜色"}})])]),t._v(" "),i("li",{staticClass:"flex1"},[i("div",{staticClass:"sig_bgfile"},[i("input",{staticClass:"upfiles",attrs:{id:"upimgs",type:"file",accept:"image/*"}}),t._v(" "),i("button",{attrs:{type:"button"}},[t._v("上传背景")])])])])]),t._v(" "),i("div",{staticClass:"btnbox"},[i("ul",{staticClass:"flexbox"},[i("li",{staticClass:"flex1"},[i("button",{attrs:{id:"sig_clear",type:"button"}},[t._v("清空画布")])]),t._v(" "),i("li",{staticClass:"flex1"},[i("button",{attrs:{id:"save_sig",type:"button"},on:{click:t.createImg}},[t._v("生成图片")])])])])])]),t._v(" "),i("transition",{attrs:{name:"fade"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:t.showSaveStatus,expression:"showSaveStatus"}],staticClass:"create_imgs"},[i("div",{staticClass:"modal_bg",on:{click:t.closeSaveImg}}),t._v(" "),i("div",{staticClass:"create_imgbox",on:{touchstart:t.saveImgs,touchend:t.closeSaves}})])])],1)])},staticRenderFns:[]};var c=i("VU/8")(o,n,!1,function(t){i("1XsU")},"data-v-011a5df6",null);e.default=c.exports},mvHQ:function(t,e,i){t.exports={default:i("qkKv"),__esModule:!0}},qkKv:function(t,e,i){var a=i("FeBl"),s=a.JSON||(a.JSON={stringify:JSON.stringify});t.exports=function(t){return s.stringify.apply(s,arguments)}}});
//# sourceMappingURL=5.4d1677baa783a21a897d.js.map